---
title: "传输安全" # 标题
date: 2021-10-02T01:34:28+08:00    # 创建时间
lastmod: 2021-10-02T01:34:28+08:00 # 最后修改时间
tags: ['网络']
categories: ['网络']  # 分类
---
## 预备知识

# 加密安全基础

**对称加密**，Aes，可逆 ,唯一密钥

- 加解密同一密钥，**传统加解密**

**非对称加密** RSA，  私钥和公钥  ,可逆

- 使用场景
  - https：非对称传送 对称算法的秘钥（密钥的一部分）等
  - ssh：本地公钥请求服务器私钥验证身份（因为私钥难破解，信息多）
- RSA比较复杂，耗费CPU
- 加/解密和签/验签
- 验签：**消息和私钥加密的消息**，发送给大家（公钥），大家公钥解密加密的消息发现和消息一致
  - ssh方法，本地用私钥进行加密发给服务器，服务器用公钥验证（私钥难以伪造，安全高）
  - Github：同理GitHub给公钥，自己本地私钥
- 加密：服务器存有私和公钥，然后发送公钥给要沟通的用户，**用户用公钥加密消息，服务器用私钥解密**
  - https所采用的，公钥在证书内

不可逆加密/Hash：md5，SHA1.....

- 场景
  - 验证正确性
  - jwt，数据库存储

**JwtToken**

- 一般采用HMAC-SHA-1 + 次数
- SHA256不需要盐，但是**HMAC-SHA256需要盐**

  - HMAC 是一种对称算法
- 算法是不可逆的

  - 采用base64编码

[HS256和RS256]: https://www.jianshu.com/p/cba0dfe4ad4a
[jwttoken]: https://www.cnblogs.com/aaron911/p/11300062.html
## RSA非对称加密

### 组成部分

KeyGen（密钥生成算法），Encrypt（加密算法）以及Decrypt（解密算法）

- 双质数+模数的方式

**如果私钥想生成多个公钥**：RSA的公钥（N，E），私钥D   私钥和公钥的关系是 `ed=1 mod \phi(N)` 所以n不同e就不同，公钥就不同。不过得注意的是一般**私钥对应公钥的N是固定的**

### 公私钥不能互换

1. 私钥的长度和公钥长度不一样
2. 有些情况，私钥存储**公共模数N的因子P,Q**（可以推导N），而私钥和公钥对应的公共指数E（固定常数），私有指数D（随机），关系是 `ed=1 mod \phi(N)`  , 那么N推导出来后，如果当E是固定的，那么很容易可以推导出D

   所以公共指数如果非随机（正常都是非随机的），会被推导出来（也就是所谓的私钥生成公钥）。
3. 安全问题，**公共指数一般比较小，为了快速验签**，`由ed=1 mod \phi(N)`可知，当知道E（一般固定）时，对D和N枚举可能可以得出，可是代价很高，而如果当知道D时，枚举N和E的难度明显小了很多。

   > 对于 1024bit 的 ![[公式]](https://www.zhihu.com/equation?tex=N) ，私钥 ![[公式]](https://www.zhihu.com/equation?tex=d) 至少是 256bit 的
   >

原则是RSA 的公私钥互换也可以成功加解密，可是公钥和私钥有完全不同的要求，这些要求保证了 RSA 加密方案尽可能地更安全高效。

所以公私钥的长度，也就是安全程度不同（如果用e=17当私钥，d=2753当公钥，那么**私钥可以在很短的时间内被穷举**出来），所以是**不可互换的**

比如在Openssl中，生成公、私钥用的东西和私钥全部存在**私钥pem**里，并且openssl的公钥 `e`固定为65537（e=3，有**小指数攻击问题**）


[公私匙互换问题]: https://www.zhihu.com/question/25912483
